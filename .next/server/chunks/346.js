"use strict";exports.id=346,exports.ids=[346],exports.modules={9310:(e,r,a)=>{a.d(r,{j:()=>n});var t=a(24902);a(58072);var s=a(23179),o=a(34016);let n=async e=>{try{return(await s.A.post("/auth/google-login",e)).data.data}catch(e){throw(e?.errorData).error.messages[0]}};(0,o.D)([n]),(0,t.A)(n,"7fbf8ceed367c04425332882ac1b853950c858c14a",null)},23179:(e,r,a)=>{a.d(r,{A:()=>s});let t=a(75886).A.create({baseURL:"http://localhost:3047/api/v1",withCredentials:!0,headers:{"Content-Type":"application/json"},timeout:1e4});t.interceptors.response.use(e=>e,e=>Promise.reject({message:e.response?.data?.message||"Something went wrong",status:e.response?.status||500,originalError:e,errorData:e.response?.data}));let s=t},30346:(e,r,a)=>{a.d(r,{N$:()=>k,xA:()=>P,ip:()=>B,SG:()=>L,$$:()=>R});var t=a(24902);a(58072);var s=a(67554),o=a(9310),n=a(23179),l=a(29246),i=a(8797),c=a(30870);async function d(e,r){try{return(await n.A.post("/auth/login",{email:e,password:r})).data}catch(e){if("errorData"in e){console.log("\n\n\nauthenticate error:",e.errorData);let r="Failed to authenticate user.";throw e.errorData?.error?.messages?.[0]?r=e.errorData.error.messages[0]:e.errorData?.messages?.[0]?r=e.errorData.messages[0]:e.errorData?.message?r=e.errorData.message:e.message&&(r=e.message),Error(r)}throw Error("Failed to authenticate user.")}}let{auth:u,signIn:f,signOut:w,handlers:h}=(0,s.Ay)({...{session:{strategy:"jwt",maxAge:2592e3},pages:{signIn:"/login"},callbacks:{async signIn({user:e,account:r,profile:a,email:t,credentials:s}){if(console.log("\n\n\nuser from signIn: ",e),console.log("\n\n\naccount from signIn: ",r),console.log("\n\n\nprofile from signIn: ",a),console.log("\n\n\nemail from signIn: ",t),console.log("\n\n\ncredentials from signIn: ",s),r?.provider==="google"){let r={email:e.email,name:e.name,authProvider:"google",googleId:a?.sub,emailVerified:!0},t=await (0,o.j)(r);if(t?.length>0&&t[0].token){console.log("\n\n\nuserRes from signIn: ",t);let r=t[0].user;return e.id=r._id,e.authProvider="google",e.name=r.name,e.email=r.email,e.token=t[0].token,e.userInfo=r,!0}return!1}return!0},jwt:async({token:e,user:r})=>(r&&(e.user=r?.userInfo,e.jwt=r?.token||e.jwt),e),async session({session:e,token:r}){let a=r.user;e.user=a,e.jwt=r.jwt,e.permissions=[];let{userGroup:t}=a;if(t){let r=t?.permissions;if(r)for(let a of r){let r=a?.module?.name;r&&a?.actions?.forEach(a=>{e.permissions.push(`${r.toLowerCase()}.${a?.toLowerCase()}`)})}}return e},authorized({auth:e,request:{nextUrl:r}}){let a=!!e?.user,t="/login"===r.pathname;return a||t?a&&t?"admin"===e.user?.role?Response.redirect(new URL("/admin/dashboard",r)):Response.redirect(new URL("/",r)):"/"!==r.pathname||("admin"===e?.user?.role?Response.redirect(new URL("/admin/dashboard",r)):Response.redirect(new URL("/",r))):Response.redirect(new URL("/login",r))}},providers:[]},providers:[(0,l.A)({name:"Credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},authorize:async e=>{let r=c.Ik({email:c.Yj().email(),password:c.Yj().min(6)}).safeParse(e);if(r.success){let{email:e,password:a}=r.data,t=await d(e,a);if(!t)return null;if("success"===t.status){let e=t.data[0].user;return{id:e._id,name:e.name,email:e.email,token:t.data[0].token,userInfo:e}}}return null}}),(0,i.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET})]});var g=a(33011),m=a(34016);let p=async()=>{let e=await u();return e?.user?(await n.A.get("/users/projects",{headers:{Authorization:`Bearer ${e.jwt}`}})).data.data:[]},A=async e=>{let r=await u();if(!r?.user)return[];let a=(await n.A.post("/users/projects",e,{headers:{Authorization:`Bearer ${r.jwt}`}})).data;if("error"===a.status)throw console.log("==========addProject=========="),console.log("result: ",a),Error(a.data[0].message);return a.data},j=async e=>{let r=[],a=null;try{let t=await u();if(!t?.user)return a="Unauthorized",{data:r,error:a};r=(await n.A.get(`/users/projects/${e}`,{headers:{Authorization:`Bearer ${t.jwt}`}})).data.data[0]}catch(e){if(e instanceof g.pe){let r=e?.response?.data;console.log("errorData: ",r),a=r.error.messages[0]}else a=e.message}return{data:r,error:a}},b=async e=>{let r=await u();if(!r?.user)return[];let a=(await n.A.delete(`/users/projects/${e}`,{headers:{Authorization:`Bearer ${r.jwt}`}})).data;if("error"===a.status)throw Error(a.data[0].message);return a.data},y=async(e,r)=>{let a=await u();if(!a?.user)return[];let t=(await n.A.put(`/users/projects/${e}`,r,{headers:{Authorization:`Bearer ${a.jwt}`}})).data;if("error"===t.status)throw Error(t.data[0].message);return t.data},E=async e=>{let r=await u();if(!r?.user)return[];try{let a=(await n.A.get(`/users/projects/${e}/users`,{headers:{Authorization:`Bearer ${r.jwt}`}})).data;if("error"===a.status)throw Error(a.data[0].message);return a.data}catch(e){return console.warn("Project users API endpoint not available yet:",e),[]}},$=async(e,r)=>{let a=await u();if(!a?.user)throw Error("Unauthorized");try{let t=(await n.A.post(`/users/projects/${e}/users`,{userId:r},{headers:{Authorization:`Bearer ${a.jwt}`}})).data;if("error"===t.status)throw Error(t.data[0].message);return t.data}catch(e){throw console.error("Error adding user to project:",e),Error("Failed to add user to project. Please try again.")}},z=async(e,r)=>{let a=await u();if(!a?.user)throw Error("Unauthorized");try{let t=(await n.A.delete(`/users/projects/${e}/users/${r}`,{headers:{Authorization:`Bearer ${a.jwt}`}})).data;if("error"===t.status)throw Error(t.data[0].message);return t.data}catch(e){throw console.error("Error removing user from project:",e),Error("Failed to remove user from project. Please try again.")}},v=async(e,r)=>{let a=await u();if(!a?.user)throw Error("Unauthorized");try{let t=(await n.A.post(`/users/projects/${e}/calls`,{callId:r},{headers:{Authorization:`Bearer ${a.jwt}`}})).data;if("error"===t.status)throw Error(t.data[0].message);return t.data}catch(e){throw console.error("Error adding call to project:",e),Error("Failed to add call to project. Please try again.")}},I=async(e,r)=>{let a=await u();if(!a?.user)throw Error("Unauthorized");try{let t=(await n.A.delete(`/users/projects/${e}/calls/${r}`,{headers:{Authorization:`Bearer ${a.jwt}`}})).data;if(console.log("\n\n===============>>>>>result: ",t),"error"===t.status)throw Error(t.data[0].message);return t.data}catch(e){throw console.error("Error removing call from project:",e),Error("Failed to remove call from project. Please try again.")}},D=async(e,r)=>{let a=await u();if(!a?.user)throw Error("Unauthorized");try{let t=(await n.A.post(`/users/projects/${e}/calls`,{callIds:r},{headers:{Authorization:`Bearer ${a.jwt}`}})).data;if("error"===t.status)throw Error(t.data[0].message);return t.data}catch(e){throw console.error("Error adding calls to project:",e),Error("Failed to add calls to project. Please try again.")}};(0,m.D)([p,A,j,b,y,E,$,z,v,I,D]),(0,t.A)(p,"7f0c88e06b3bad703ae193f0f52e050d3be0abe413",null),(0,t.A)(A,"7fdc65967da6e1c64afb55a4baba88495fddfa28df",null),(0,t.A)(j,"7fbb8e4164106ecb89672208ff12b7e157dde22a52",null),(0,t.A)(b,"7fcacaf4d942fb25f7ee111fc3a1964d895c639f4b",null),(0,t.A)(y,"7fe8be6f50d158bd0073e6601575b8573865633d7e",null),(0,t.A)(E,"7fac1e6f69684577729c62c70547d5c2bba4a86072",null),(0,t.A)($,"7f49e83c0165e8d5d7cc80af01d567c6c8a92d2389",null),(0,t.A)(z,"7f5970b6c0de47a93832f40328853e89a90fa24ad4",null),(0,t.A)(v,"7f922df92c230b795598e30cad6e1589c7b6e93962",null),(0,t.A)(I,"7f090f9e5a34fb1f7be8d888b9f14f870fdb2a0d7c",null),(0,t.A)(D,"7fb018cc823e171de450c7c5d722fd8e4049baedec",null);let U=async(e,r,a,t)=>{let s=await u();if(!s?.user)return[];let o=(await n.A.put(`/users/projects/${e}/calls/${r}/feedbacks/${a}/transcript`,{transcript:t},{headers:{Authorization:`Bearer ${s.jwt}`}})).data;if("error"===o.status)throw Error(o.data[0].message);return o.data[0]},k=async e=>{try{let r=await A(e);return{success:!0,project:r}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},P=async(e,r)=>{try{let a=await $(e,r);return{success:!0,data:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},R=async(e,r)=>{try{let a=await z(e,r);return{success:!0,data:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}},B=async(e,r,a)=>{console.log("==========callEndTranscriptAction=========="),console.log("call: ",e),console.log("\n\n\n"),console.log("transcript: ",a);let t=await U(e.project.id,e.id,r,a);console.log("\n\n\n"),console.log("updateFeedbackTranscript: res: ",t)},L=async e=>{let r=await u();if(!r?.user)return!1;if("admin"===r.user?.role)return!0;let a=r.permissions||[];return e.every(e=>a.includes(e))};(0,m.D)([k,P,R,B,L]),(0,t.A)(k,"7f143444e3e400671830be6ce02b3ff1d3e9dbf1cc",null),(0,t.A)(P,"7f5a97f4138773f7d8f8713e6048ccd0fe6d20e7a2",null),(0,t.A)(R,"7f228af614aba0103daf10d4c57416d697ff32364b",null),(0,t.A)(B,"7f804d520220bdd31092be9af94ca7c8191040f035",null),(0,t.A)(L,"7fdffce87a84d5c83ee3356c6e33814b2d8fad3291",null)}};